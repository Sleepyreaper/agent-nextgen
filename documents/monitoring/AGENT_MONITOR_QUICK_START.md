# ğŸ¤– Agent Monitor - Quick Reference

## âš¡ 30-Second Setup

Your monitoring system is now live and ready to use:

```
1. Start your application (python app.py)
2. Open your browser: http://localhost:5002/debug/agents
3. Upload a student application 
4. WATCH AGENTS EXECUTE IN REAL-TIME âœ¨
```

---

## ğŸ¯ What You'll See

### The Dashboard

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 ğŸ¤– Agent Monitor - Real-Time Execution Tracker
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

 Metrics:
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Total Agent Calls: 47  â”‚ Running: 1  â”‚ Errors: 0  â”‚ Avg: 3.2s â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 Currently Running:
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ ğŸ¤– Naveen (School Data Scientist)         [â³ Running]  â”‚
 â”‚    Model: o4miniagent                                      â”‚
 â”‚    Elapsed: 2.3s                                           â”‚
 â”‚    â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 Recent Executions:
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Agent                      â”‚ Status  â”‚ Duration â”‚ Time     â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Naveen (School Data...)    â”‚ âœ… done â”‚ 4,850ms  â”‚ 14:32:10 â”‚
 â”‚ Moana (School Context)     â”‚ âœ… done â”‚ 2,100ms  â”‚ 14:32:05 â”‚
 â”‚ Tiana (Application...)     â”‚ âœ… done â”‚ 1,900ms  â”‚ 14:31:59 â”‚
 â”‚ Rapunzel (Grade Reader)    â”‚ âœ… done â”‚ 980ms    â”‚ 14:31:57 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Real-Time Observations

### As Workflow Executes:

**Timeline:**
```
14:31:57 â†’ Rapunzel starts (grades reading)
14:31:58 â†’ Rapunzel completes (980ms)
14:31:59 â†’ Tiana starts (application reading + school extraction)
14:32:00 â†’ Tiana completes (1.9s)
           [School "Lincoln High School" extracted!]
14:32:01 â†’ Naveen starts (â³ â† THIS IS WHAT WAS INVISIBLE BEFORE!)
14:32:06 â†’ Naveen completes (4.8s) âœ…
14:32:07 â†’ Moana starts (context analysis with enriched school data)
14:32:08 â†’ Moana completes (1.6s)
14:32:09 â†’ [...evaluation continues...]
```

---

## ğŸš€ Key Features

### âœ… Auto-Refresh
Dashboard refreshes every 2 seconds automatically
- No manual refresh needed
- See changes in real-time

### âœ… Running Agents
See animated progress bars for agents currently executing
- Shows elapsed time
- Displays model being used
- Automatic error detection

### âœ… History Tracking
Keep 10 recent executions visible
- See complete execution timeline
- Identify patterns or bottlenecks
- Check error messages

### âœ… Error Detection
Instant visibility when agents fail:
```
Agent Status: âŒ Failed
Error: "OpenAI API timed out after 30 seconds"
```

---

## ğŸ”§ Control Buttons

On the dashboard you'll find:

**ğŸ”„ Refresh Now**
- Manually update immediately (normally auto-refreshes)
- Useful if you want immediate update

**ğŸ—‘ï¸ Clear History**
- Resets execution history (not currently running agents)
- Start fresh for clean testing

**â¹ï¸ Auto-refresh Checkbox**
- Toggle automatic 2-second refresh
- Uncheck to pause updates

---

## ğŸ¯ Troubleshooting with Monitor

### Issue: "Naveen not running"
1. Look for Naveen in "Currently Running" section
   - If not there: Check if Tiana successfully extracted school name
2. Look in "Recent Executions" for Naveen
   - If not listed: Moana is being skipped (school name missing)
3. Check Moana's status
   - If "âŠ˜ Skipped": School name extraction failed in Tiana

### Issue: "Naveen running too long"
1. Check timer - how long has it been running?
   - Normal: 3-8 seconds
   - Long: 15+ seconds might indicate:
     - Complex school name requiring research
     - Azure OpenAI busy
     - Network latency
2. Check Azure Portal for OpenAI quotas
3. See detailed logs: `tail -f logs/app.log | grep -i naveen`

### Issue: "Naveen shows error"
1. Click on the error message in dashboard
2. Shows error type and details
3. Common errors:
   - `âŒ School "XYZ High School" not found` â†’ Typo in school name
   - `âŒ OpenAI API timeout` â†’ Check quota or service health
   - `âŒ Database error` â†’ PostgreSQL connection issue

---

## ğŸ“Š API Endpoints (For Advanced Users)

If you want to fetch data programmatically:

```bash
# Get current status (returns JSON)
curl http://localhost:5002/api/debug/agent-status

# Get history for specific agent (limit 50)
curl http://localhost:5002/api/debug/agent/Naveen/history?limit=50

# Clear history (POST request)
curl -X POST http://localhost:5002/api/debug/agent-status/clear
```

---

## ğŸ“ What Agents Report

Our system is now monitoring:
- **Naveen** (School Data Scientist) âœ… Instrumented
- **Tiana** (Application Reader) âœ… Can be instrumented
- **Rapunzel** (Grade Reader) âœ… Can be instrumented
- **Moana** (School Context) âœ… Can be instrumented
- **Merlin** (Student Evaluator) âœ… Can be instrumented
- **All others** âœ… Can be instrumented

Each shows:
- Start time, end time, total duration
- Status (running/completed/failed)
- Model used (gpt-4, o4miniagent, etc.)
- Error messages if failed

---

## ğŸš¨ Important Notes

**The Monitor Shows:**
- âœ… Agent execution start/end times
- âœ… Agent status (running, completed, failed)
- âœ… Model being used
- âœ… Execution duration
- âœ… Error messages

**What to do if:**
- **Agent doesn't appear** â†’ Not instrumented yet OR skipped (check Moana for "skipped" status)
- **Agent hangs** â†’ Normal for complex operations; Naveen typically takes 3-8 seconds
- **Agent fails** â†’ See error message for specifics; check logs with `grep -i error logs/app.log`

---

## ğŸ“ Example Workflow

**Student uploads application for "Lincoln High School, CA"**

```
Time  Agent Name                     Status       Duration
----  -----------------------------------          --------
0s    Rapunzel (Grade Reader)        â³ Running
1s    Rapunzel (Grade Reader)        âœ… Completed  980ms
1s    Tiana (Application Reader)     â³ Running
3s    Tiana (Application Reader)     âœ… Completed  1.9s
      [Tiana extracts: school_name="Lincoln High School", state="CA"]
3s    Naveen (School Data...)        â³ Running
      [Checking database... NOT CACHED!]
      [Calling Naveen to analyze school...]
8s    Naveen (School Data...)        âœ… Completed  4.8s
      [School stored in cache]
8s    Moana (School Context)         â³ Running
      [Using Naveen's enriched data]
10s   Moana (School Context)         âœ… Completed  1.6s
10s   Merlin (Student Evaluator)    â³ Running
...   [... evaluation continues ...]
```

**Next student uploads for SAME school:**
```
0s    Rapunzel (Grade Reader)        â³ Running
1s    Rapunzel (Grade Reader)        âœ… Completed  980ms
1s    Tiana (Application Reader)     â³ Running
3s    Tiana (Application Reader)     âœ… Completed  1.9s
      [Tiana extracts: school_name="Lincoln High School", state="CA"]
3s    Naveen (School Data...)        âŠ˜ SKIPPED
      [School already in cache - Naveen NOT called!]
3s    Moana (School Context)         â³ Running
      [Using CACHED school data from before]
4s    Moana (School Context)         âœ… Completed  1.1s
      [Moana completes FASTER due to cached data!]
...
```

---

## ğŸ¯ Your Next Steps

1. **Commit this code** â† You just did! âœ…
2. **Deploy to your server** â† App will have monitoring built-in
3. **Run a test workflow**:
   - Upload a student application
   - Watch the dashboard fill with execution data
   - See Naveen running (finally!)
4. **If issues occur**:
   - Check `/debug/agents` dashboard
   - Use the debugging guide: `AGENT_DEBUGGING_GUIDE.md`
   - Review logs: `tail -f logs/app.log`

---

## ğŸ“ Support

If you need more detailed monitoring:
- Check `AGENT_DEBUGGING_GUIDE.md` for detailed troubleshooting
- Review `TELEMETRY_IMPLEMENTATION_GUIDE.md` for adding monitoring to more agents
- See `src/agents/agent_monitor.py` for the implementation

Your visibility into agent execution is now complete! ğŸ‰
